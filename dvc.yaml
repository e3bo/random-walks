stages:
  hopkins-2020-10-12:
    cmd: fdt=2020-10-12 ./pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-10-12
  forecast-2020-10-12:
    cmd: fdt=2020-10-12 Rscript sir-kf-forecast.R
    deps:
    - covidhub-common.R
    - hopkins/2020-10-12
    - sir-kf-forecast.R
    outs:
    - forecasts/2020-10-12-CEID-SIR_KF.csv
    metrics:
    - metrics/2020-10-12-forecast-calc-time.json:
        cache: false
  hopkins-2021-01-11:
    cmd: fdt=2021-01-11 ./pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2021-01-11
  forecast-2021-01-11:
    cmd: fdt=2021-01-11 Rscript sir-kf-forecast.R
    deps:
    - covidhub-common.R
    - hopkins/2021-01-11
    - sir-kf-forecast.R
    outs:
    - forecasts/2021-01-11-CEID-SIR_KF.csv
    metrics:
    - metrics/2021-01-11-forecast-calc-time.json:
        cache: false
  score-2021-01-11:
    cmd: ddt=2021-01-11 ./quantile-score.R
    deps:
    - covidhub-common.R
    - forecasts
    - hopkins/2021-01-11
    - quantile-score.R
    outs:
    - metrics/2021-01-11-residuals.rds
    plots:
    - metrics/2021-01-11-score-by-loc-type-targ-type-forecast-date.csv:
        cache: false
        template: lqs-loctype-targtype-panels
        x: forecast_date
    - metrics/2021-01-11-score-by-loc-type-targ-type.csv:
        cache: false
        template: lqs-loctype-panel
        x: target_type
    - metrics/2021-01-11-score-by-loc-type.csv:
        cache: false
        template: lqs
        x: loc_type
        x_label: Location type
