stages:
  hopkins-2020-08-03:
    cmd: fdt=2020-08-03 ./pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-08-03
  hopkins-2020-07-26:
    cmd: fdt=2020-07-26 Rscript pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-07-26
  score-2020-08-03:
    cmd: ddt=2020-08-03 Rscript quantile-score.R
    deps:
    - covidhub-common.R
    - forecasts
    - hopkins/2020-08-03
    - quantile-score.R
    outs:
    - metrics/2020-08-03-residuals.rds
    plots:
    - metrics/2020-08-03-score-by-loc-type-targ-type-forecast-date.csv:
        cache: false
        template: lqs-loctype-targtype-panels
        x: forecast_date
    - metrics/2020-08-03-score-by-loc-type-targ-type.csv:
        cache: false
        template: lqs-loctype-panel
        x: target_type
    - metrics/2020-08-03-score-by-loc-type.csv:
        cache: false
        template: lqs.json
        x: loc_type
        x_label: Location type
  hopkins-2020-07-19:
    cmd: fdt=2020-07-19 Rscript pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-07-19
  hopkins-2020-07-12:
    cmd: fdt=2020-07-12 Rscript pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-07-12
  hopkins-2020-07-05:
    cmd: fdt=2020-07-05 Rscript pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-07-05
  hopkins-2020-08-09:
    cmd: fdt=2020-08-09 ./pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-08-09
  visualize-forecast-2020-08-09-and-data-2020-08-09:
    cmd: ddt=2020-08-09 fdt=2020-08-09 ./forecast-vis.R
    deps:
    - covidhub-common.R
    - forecast-vis.R
    - forecasts/2020-08-09-CEID-Walk.csv
    - hopkins/2020-08-09
    outs:
    - visuals/fdt2020-08-09-ddt2020-08-09-cum-death-forecasts.png
    - visuals/fdt2020-08-09-ddt2020-08-09-inc-case-forecasts.pdf
    - visuals/fdt2020-08-09-ddt2020-08-09-inc-death-forecasts.png
  hopkins-2020-08-16:
    cmd: fdt=2020-08-16 ./pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-08-16
  score-2020-08-16:
    cmd: ddt=2020-08-16 ./quantile-score.R
    deps:
    - covidhub-common.R
    - forecasts
    - hopkins/2020-08-16
    - quantile-score.R
    outs:
    - metrics/2020-08-16-residuals.rds
    plots:
    - metrics/2020-08-16-score-by-loc-type-targ-type-forecast-date.csv:
        cache: false
        template: lqs-loctype-targtype-panels
        x: forecast_date
    - metrics/2020-08-16-score-by-loc-type-targ-type.csv:
        cache: false
        template: lqs-loctype-panel
        x: target_type
    - metrics/2020-08-16-score-by-loc-type.csv:
        cache: false
        template: lqs
        x: loc_type
        x_label: Location type
  visualize-forecast-2020-08-16-and-data-2020-08-16:
    cmd: ddt=2020-08-16 fdt=2020-08-16 ./forecast-vis.R
    deps:
    - covidhub-common.R
    - forecast-vis.R
    - forecasts/2020-08-16-CEID-Walk.csv
    - hopkins/2020-08-16
    outs:
    - visuals/fdt2020-08-16-ddt2020-08-16-cum-death-forecasts.png
    - visuals/fdt2020-08-16-ddt2020-08-16-inc-case-forecasts.pdf
    - visuals/fdt2020-08-16-ddt2020-08-16-inc-death-forecasts.png
  hopkins-2020-08-23:
    cmd: fdt=2020-08-23 ./pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-08-23
  score-2020-08-23:
    cmd: ddt=2020-08-23 ./quantile-score.R
    deps:
    - covidhub-common.R
    - forecasts
    - hopkins/2020-08-23
    - quantile-score.R
    outs:
    - metrics/2020-08-23-residuals.rds
    plots:
    - metrics/2020-08-23-score-by-loc-type-targ-type-forecast-date.csv:
        cache: false
        template: lqs-loctype-targtype-panels
        x: forecast_date
    - metrics/2020-08-23-score-by-loc-type-targ-type.csv:
        cache: false
        template: lqs-loctype-panel
        x: target_type
    - metrics/2020-08-23-score-by-loc-type.csv:
        cache: false
        template: lqs
        x: loc_type
        x_label: Location type
  visualize-forecast-2020-08-23-and-data-2020-08-23:
    cmd: ddt=2020-08-23 fdt=2020-08-23 ./forecast-vis.R
    deps:
    - covidhub-common.R
    - forecast-vis.R
    - forecasts/2020-08-23-CEID-Walk.csv
    - hopkins/2020-08-23
    outs:
    - visuals/fdt2020-08-23-ddt2020-08-23-cum-death-forecasts.png
    - visuals/fdt2020-08-23-ddt2020-08-23-inc-case-forecasts.pdf
    - visuals/fdt2020-08-23-ddt2020-08-23-inc-death-forecasts.png
  hopkins-2020-08-30:
    cmd: fdt=2020-08-30 ./pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-08-30
  score-2020-08-30:
    cmd: ddt=2020-08-30 ./quantile-score.R
    deps:
    - covidhub-common.R
    - forecasts
    - hopkins/2020-08-30
    - quantile-score.R
    outs:
    - metrics/2020-08-30-residuals.rds
    plots:
    - metrics/2020-08-30-score-by-loc-type-targ-type-forecast-date.csv:
        cache: false
        template: lqs-loctype-targtype-panels
        x: forecast_date
    - metrics/2020-08-30-score-by-loc-type-targ-type.csv:
        cache: false
        template: lqs-loctype-panel
        x: target_type
    - metrics/2020-08-30-score-by-loc-type.csv:
        cache: false
        template: lqs
        x: loc_type
        x_label: Location type
  visualize-forecast-2020-08-30-and-data-2020-08-30:
    cmd: ddt=2020-08-30 fdt=2020-08-30 ./forecast-vis.R
    deps:
    - covidhub-common.R
    - forecast-vis.R
    - forecasts/2020-08-30-CEID-Walk.csv
    - hopkins/2020-08-30
    outs:
    - visuals/fdt2020-08-30-ddt2020-08-30-cum-death-forecasts.png
    - visuals/fdt2020-08-30-ddt2020-08-30-inc-case-forecasts.pdf
    - visuals/fdt2020-08-30-ddt2020-08-30-inc-death-forecasts.png
  weight-2020-08-03:
    cmd: ddt=2020-08-03 ./optimally-weight.R
    deps:
    - drift/metrics/2020-08-03-residuals.rds
    - no-drift/metrics/2020-08-03-residuals.rds
    - optimally-weight.R
    outs:
    - model-weights/2020-08-03-weights.csv
  combine-2020-08-03:
    cmd: fdt=2020-08-03 ./combine-forecasts.R
    deps:
    - combine-forecasts.R
    - drift/forecasts/2020-08-03-CEID-Walk.csv
    - model-weights/2020-08-03-weights.csv
    - no-drift/forecasts/2020-08-03-CEID-Walk.csv
    outs:
    - forecasts/2020-08-03-CEID-Walk.csv
  hopkins-2020-08-10:
    cmd: fdt=2020-08-10 ./pull-hopkins-ts-from-date.R
    deps:
    - pull-hopkins-ts-from-date.R
    outs:
    - hopkins/2020-08-10
  score-2020-08-10:
    cmd: ddt=2020-08-10 ./quantile-score.R
    deps:
    - covidhub-common.R
    - forecasts
    - hopkins/2020-08-10
    - quantile-score.R
    outs:
    - metrics/2020-08-10-residuals.rds
    plots:
    - metrics/2020-08-10-score-by-loc-type-targ-type-forecast-date.csv:
        cache: false
        template: lqs-loctype-targtype-panels
        x: forecast_date
    - metrics/2020-08-10-score-by-loc-type-targ-type.csv:
        cache: false
        template: lqs-loctype-panel
        x: target_type
    - metrics/2020-08-10-score-by-loc-type.csv:
        cache: false
        template: lqs
        x: loc_type
        x_label: Location type
  visualize-forecast-2020-08-03-and-data-2020-08-03:
    cmd: ddt=2020-08-03 fdt=2020-08-03 ./forecast-vis.R
    deps:
    - covidhub-common.R
    - forecast-vis.R
    - forecasts/2020-08-03-CEID-Walk.csv
    - hopkins/2020-08-03
    outs:
    - visuals/fdt2020-08-03-ddt2020-08-03-cum-death-forecasts.png
    - visuals/fdt2020-08-03-ddt2020-08-03-inc-case-forecasts.pdf
    - visuals/fdt2020-08-03-ddt2020-08-03-inc-death-forecasts.png
  weight-2020-07-05:
    cmd: ddt=2020-07-05 ./optimally-weight.R
    deps:
    - drift/metrics/2020-07-05-residuals.rds
    - no-drift/metrics/2020-07-05-residuals.rds
    - optimally-weight.R
    outs:
    - model-weights/2020-07-05-weights.csv
  weight-2020-07-12:
    cmd: ddt=2020-07-12 ./optimally-weight.R
    deps:
    - drift/metrics/2020-07-12-residuals.rds
    - no-drift/metrics/2020-07-12-residuals.rds
    - optimally-weight.R
    outs:
    - model-weights/2020-07-12-weights.csv
  weight-2020-07-19:
    cmd: ddt=2020-07-19 ./optimally-weight.R
    deps:
    - drift/metrics/2020-07-19-residuals.rds
    - no-drift/metrics/2020-07-19-residuals.rds
    - optimally-weight.R
    outs:
    - model-weights/2020-07-19-weights.csv
  weight-2020-07-26:
    cmd: ddt=2020-07-26 ./optimally-weight.R
    deps:
    - drift/metrics/2020-07-26-residuals.rds
    - no-drift/metrics/2020-07-26-residuals.rds
    - optimally-weight.R
    outs:
    - model-weights/2020-07-26-weights.csv
  weight-2020-08-09:
    cmd: ddt=2020-08-09 ./optimally-weight.R
    deps:
    - drift/metrics/2020-08-09-residuals.rds
    - no-drift/metrics/2020-08-09-residuals.rds
    - optimally-weight.R
    outs:
    - model-weights/2020-08-09-weights.csv
  weight-2020-08-16:
    cmd: ddt=2020-08-16 ./optimally-weight.R
    deps:
    - drift/metrics/2020-08-16-residuals.rds
    - no-drift/metrics/2020-08-16-residuals.rds
    - optimally-weight.R
    outs:
    - model-weights/2020-08-16-weights.csv
  weight-2020-08-30:
    cmd: ddt=2020-08-30 ./optimally-weight.R
    deps:
    - drift/metrics/2020-08-30-residuals.rds
    - no-drift/metrics/2020-08-30-residuals.rds
    - optimally-weight.R
    outs:
    - model-weights/2020-08-30-weights.csv
  weight-2020-08-23:
    cmd: ddt=2020-08-23 ./optimally-weight.R
    deps:
    - drift/metrics/2020-08-23-residuals.rds
    - no-drift/metrics/2020-08-23-residuals.rds
    - optimally-weight.R
    outs:
    - model-weights/2020-08-23-weights.csv
  combine-2020-07-12:
    cmd: fdt=2020-07-12 ./combine-forecasts.R
    deps:
    - combine-forecasts.R
    - drift/forecasts/2020-07-12-CEID-Walk.csv
    - model-weights/2020-07-12-weights.csv
    - no-drift/forecasts/2020-07-12-CEID-Walk.csv
    outs:
    - forecasts/2020-07-12-CEID-Walk.csv
  combine-2020-07-19:
    cmd: fdt=2020-07-19 ./combine-forecasts.R
    deps:
    - combine-forecasts.R
    - drift/forecasts/2020-07-19-CEID-Walk.csv
    - model-weights/2020-07-19-weights.csv
    - no-drift/forecasts/2020-07-19-CEID-Walk.csv
    outs:
    - forecasts/2020-07-19-CEID-Walk.csv
  combine-2020-07-26:
    cmd: fdt=2020-07-26 ./combine-forecasts.R
    deps:
    - combine-forecasts.R
    - drift/forecasts/2020-07-26-CEID-Walk.csv
    - model-weights/2020-07-26-weights.csv
    - no-drift/forecasts/2020-07-26-CEID-Walk.csv
    outs:
    - forecasts/2020-07-26-CEID-Walk.csv
  combine-2020-08-09:
    cmd: fdt=2020-08-09 ./combine-forecasts.R
    deps:
    - combine-forecasts.R
    - drift/forecasts/2020-08-09-CEID-Walk.csv
    - model-weights/2020-08-09-weights.csv
    - no-drift/forecasts/2020-08-09-CEID-Walk.csv
    outs:
    - forecasts/2020-08-09-CEID-Walk.csv
  combine-2020-08-16:
    cmd: fdt=2020-08-16 ./combine-forecasts.R
    deps:
    - combine-forecasts.R
    - drift/forecasts/2020-08-16-CEID-Walk.csv
    - model-weights/2020-08-16-weights.csv
    - no-drift/forecasts/2020-08-16-CEID-Walk.csv
    outs:
    - forecasts/2020-08-16-CEID-Walk.csv
  combine-2020-08-30:
    cmd: fdt=2020-08-30 ./combine-forecasts.R
    deps:
    - combine-forecasts.R
    - drift/forecasts/2020-08-30-CEID-Walk.csv
    - model-weights/2020-08-30-weights.csv
    - no-drift/forecasts/2020-08-30-CEID-Walk.csv
    outs:
    - forecasts/2020-08-30-CEID-Walk.csv
  combine-2020-08-23:
    cmd: fdt=2020-08-23 ./combine-forecasts.R
    deps:
    - combine-forecasts.R
    - drift/forecasts/2020-08-23-CEID-Walk.csv
    - model-weights/2020-08-23-weights.csv
    - no-drift/forecasts/2020-08-23-CEID-Walk.csv
    outs:
    - forecasts/2020-08-23-CEID-Walk.csv
